{% comment %}
  Renders a product button

  Accepts:
  - product: {Object} Product info
  - as_icon: {Boolean} Button style

  Usage:
  {% render 'core-product-button', product: {...}, as_icon: false %}
{% endcomment %}

{% assign default_variant = product.selected_or_first_available_variant %}

{% unless product.skip_to_checkout and as_icon %}
  <ui-product-button
    quantity="1"
    variant-id="{{ default_variant.id }}"
    {% unless product.available %}
      not-available
    {% endunless %}
    {% if source %}
      source="{{ source }}"
    {% endif %}
    {% if product.skip_to_checkout %}
      skip-cart
    {% endif %}
  >
    {% if product.skip_to_checkout %}
      <button ui-button data-variant="primary" data-size="lg" class="add-to-cart">
        {{ 'general.shop_now' | t }}
      </button>
    {% else %}
      {% if as_icon %}
        <button
          ui-button
          ui-button
          data-variant="outline"
          data-size="sm"
          data-icon
          aria-label="{{ 'general.add_to_cart' | t }}"
        >
          <i class="hgi hgi-stroke hgi-plus-sign"></i>
        </button>
      {% else %}
        <button
          ui-button
          data-variant="primary"
          data-size="lg"
          class="add-to-cart"
          aria-label="{{ 'general.add_to_cart' | t }}"
          data-cta="{{ 'general.add_to_cart' | t }}"
          data-out-of-stock="{{ 'general.out_of_stock' | t }}"
        >
          <i class="hgi hgi-stroke hgi-plus-sign"></i>
        </button>
      {% endif %}
    {% endif %}
  </ui-product-button>
{% endunless %}
